import json
import cv2
from datetime import date
from utils import rle_to_mask, get_mask_img

manually_annotated_to_delete_0 = ['20221011_09-18-28', '20230119_10-25-21', '20221011_08-50-33', '20230119_11-33-32', '20230119_11-33-25',
                                  '20220928_10-51-47', '20221028_09-22-54', '20230119_09-52-27', '20221028_09-30-44', '20230119_10-01-06',
                                  '20230119_10-08-29', '20230119_11-33-52', '20230117_11-44-23', '20221025_09-29-57', '20221011_09-18-42',
                                  '20221011_08-47-30', '20221011_08-58-18', '20221028_09-44-32', '20230119_10-08-25', '20230117_10-02-16',
                                  '20221014_10-07-10', '20230117_10-38-58', '20221011_08-57-01', '20221011_11-32-48']

manually_annotated_to_delete = ['20230119_11-43-30', '20221011_11-10-57', '20230117_11-35-45', '20230119_11-55-19']

film_labeled_twice = ['20221011_08-46-48', '20221028_09-11-27', '20221011_09-15-24', '20220928_11-31-45', '20221025_09-13-35',
                      '20221028_09-36-52', '20221028_09-37-48', '20221025_09-44-29', '20221025_09-51-13', '20221025_09-13-18',
                      '20221025_09-44-16', '20220928_11-46-28', '20221011_08-46-57', '20221025_09-51-16', '20221025_09-58-08',
                      '20221011_08-47-27', '20220928_11-38-55', '20230117_11-36-23', '20221025_09-58-05', '20221011_09-15-31',
                      '20221025_09-57-52', '20221011_09-15-27', '20220928_11-38-52', '20221011_09-15-41', '20221028_09-29-48',
                      '20220928_11-24-37', '20221025_09-57-58', '20221011_09-09-26', '20221028_09-29-45', '20220928_11-31-48',
                      '20221011_08-46-15', '20221025_09-37-37', '20220928_11-38-46', '20221028_09-21-35', '20221011_09-07-04',
                      '20221011_08-50-17', '20221028_09-30-41', '20220928_11-46-41', '20221011_08-46-38', '20221028_09-44-45',
                      '20220928_11-46-31', '20220928_11-31-38', '20221025_09-50-57', '20221011_09-01-57', '20221011_09-07-10',
                      '20221025_09-20-21', '20221028_09-44-49', '20221028_09-11-14', '20221025_09-57-49', '20221011_09-15-34',
                      '20220928_11-31-42', '20221028_09-22-24', '20220928_11-46-38', '20221028_09-21-54', '20220928_11-24-31',
                      '20221028_09-44-42', '20221025_09-20-11', '20221011_09-06-57', '20221028_09-29-58', '20221028_09-21-31',
                      '20221028_09-37-15', '20221011_09-09-52', '20221028_09-21-48', '20220928_11-46-44', '20221011_09-10-21',
                      '20221025_09-29-31', '20220928_11-24-42', '20221025_09-20-24', '20220928_11-46-24', '20221025_09-58-15',
                      '20220928_11-38-49', '20221028_09-12-00', '20221011_09-07-07', '20221028_09-11-17', '20221025_09-44-33',
                      '20221028_09-12-27']

repeated_masks = ['20221028_09-12-13', '20221028_09-44-09', '20221025_09-13-15', '20221025_09-44-39', '20221028_09-11-01',
                  '20230117_10-38-51', '20221025_09-20-50', '20221028_09-21-41', '20221025_09-05-24', '20221025_09-29-28']

some_classes_none_labeled = ['20230119_09-53-03', '20221025_09-20-17', '20230119_11-36-02', '20221011_11-10-57', '20221014_10-21-04',
                             '20230119_11-43-07', '20230119_11-52-38', '20221028_09-22-18', '20221011_11-11-00', '20230117_11-15-24',
                             '20230119_10-36-42', '20230119_11-55-19', '20230117_11-59-04', '20221028_09-21-21', '20230119_09-59-53',
                             '20230117_11-15-57', '20230117_11-43-22', '20221011_09-15-11', '20221025_09-57-58', '20230117_11-14-57',
                             '20221025_09-37-37', '20220928_11-46-21', '20230117_11-14-50', '20221028_09-21-15', '20221011_11-10-50',
                             '20230117_11-16-28', '20230117_11-58-09', '20230117_11-16-01', '20230117_11-43-49', '20221028_09-30-14',
                             '20221011_08-46-28', '20230117_11-15-07', '20221028_09-22-24', '20221025_09-37-31', '20230117_11-36-30',
                             '20230117_11-15-44', '20230119_09-52-00', '20230117_11-35-25', '20221025_09-20-24', '20221011_08-47-01',
                             '20221014_10-00-44', '20221028_09-21-28', '20220928_11-38-42', '20230609_13-37-48']


# json_file = '/home/scasao/SEPARA/unizar_DL4HSI/separa/data/annotations_update/2023-09-29_all_annotations_rle.json'
# annotations = json.load(open(json_file, 'r'))
#
# ann = annotations['annotations']
# ann_img = [a for a in ann if a['image_id'] == '20221025_09-20-17' and a['category_id'] == 1]
# ann_area = [a['bbox'][2] * a['bbox'][3] for a in ann_img]
# idx_ann_to_delete = ann_area.index(max(ann_area))
# ann_to_delete = ann_img[idx_ann_to_delete]
# # mask_bool = rle_to_mask(ann_to_delete['segmentation'][0])
# # mask_img = get_mask_img(mask_bool, (255, 182, 219, 1))
# ann.remove(ann_to_delete)
#
# for i, a in enumerate(ann):
#     a['id'] = i
# annotations['annotations'] = ann
#
# current_date = date.today()
# current_date = current_date.strftime("%Y-%m-%d_")
# name_file = current_date + 'all_annotations_rle.json'
# dir_file = '/home/scasao/SEPARA/unizar_DL4HSI/separa/data/annotations_update/' + name_file
# with open(dir_file, 'w') as outfile:
#     json.dump(annotations, outfile)

